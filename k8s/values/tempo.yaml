# k8s/values/tempo.yaml
global:
  extraEnvFrom:
    - secretRef:
        name: tempo-s3-credentials

tempo:
  multitenancyEnabled: true
  
  # âœ… FIX: Explicitly bind HTTP to 3100 to match Service & Grafana
  server:
    http_listen_port: 3100
    grpc_listen_port: 9095

  resources:
    requests:
      cpu: 50m
      memory: 128Mi
    limits:
      memory: 512Mi

  receivers:
    otlp:
      protocols:
        grpc:
          endpoint: "0.0.0.0:4317"
        http:
          endpoint: "0.0.0.0:4318"

  storage:
    trace:
      backend: s3
      s3:
        bucket: tempo-data
        endpoint: loki-minio.observability-prd.svc:9000
        insecure: true

persistence:
  enabled: false

ingress:
  enabled: false

service:
  type: ClusterIP
  ports:
    - name: prom-metrics
      port: 3100
      targetPort: 3100
      protocol: TCP
    - name: otlp-grpc
      port: 4317
      targetPort: 4317
      protocol: TCP
    - name: otlp-http
      port: 4318
      targetPort: 4318
      protocol: TCP